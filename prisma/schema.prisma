// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:app.db"
}

model Speakers {
  id              Int               @id @default(autoincrement())
  label           String            @unique
  size            Decimal
  coilResistance  Decimal
  description     String?
  MeasurementMeta MeasurementMeta[]
}

model Cabinets {
  id              Int               @id @default(autoincrement())
  volume          Decimal
  speakerSize     Decimal
  description     String?
  MeasurementMeta MeasurementMeta[]

  @@unique([volume, speakerSize])
}

model Ports {
  id              Int               @id @default(autoincrement())
  diameter        Decimal
  length          Decimal
  description     String?
  MeasurementMeta MeasurementMeta[]

  @@unique([diameter, length])
}

model Cars {
  id              Int               @id @default(autoincrement())
  label           String            @unique
  description     String?
  MeasurementMeta MeasurementMeta[]
}

model MeasurementFrame {
  frequency         Int
  Uin               Decimal
  I                 Decimal
  Pa                Decimal
  measurementCase   MeasurementCases @relation(fields: [measurementCaseId], references: [id], onDelete: Cascade)
  measurementCaseId Int

  @@id(name: "compositeId", [measurementCaseId, frequency])
}

model MeasurementMeta {
  id                Int              @id @default(autoincrement())
  speaker           Speakers         @relation(fields: [speakerId], references: [id])
  speakerId         Int
  cabinet           Cabinets         @relation(fields: [cabinetId], references: [id])
  cabinetId         Int
  port              Ports            @relation(fields: [portId], references: [id])
  portId            Int
  car               Cars             @relation(fields: [carId], references: [id])
  carId             Int
  isDoorOpened      Boolean
  voltageOfTesting  Decimal
  description       String?
  measurementCase   MeasurementCases @relation(fields: [measurementCaseId], references: [id], onDelete: Cascade)
  measurementCaseId Int              @unique
}

model MeasurementCases {
  id   Int                @id @default(autoincrement())
  meta MeasurementMeta?
  data MeasurementFrame[]
}
